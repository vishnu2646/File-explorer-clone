<div class="header">
    <h3 class="title">File Viewer</h3>
    <mat-icon color="primary" (click)="handleToggleSideNav()">{{ toggleSideNav ? 'close' : 'menu'}}</mat-icon>
</div>
<div class="file-explorer-container">
    <!-- Left Pane: Folder Navigation -->
    <div class="folder-pane" [ngClass]="{'open': toggleSideNav}">
        <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                <div matTreeNodePadding>
                    <div class="folder_icon" (click)="selectFolder(node)">
                        <mat-icon color="accent">{{ selectedFolder.name === node.name ? 'folder_open' : 'folder' }}</mat-icon>
                    </div>
                    <span class="folder_name" (click)="selectFolder(node)">{{node.name}}</span>
                </div>
            </mat-nested-tree-node>
    
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
                <button mat-icon-button color="primary" disabled></button>
                <mat-icon>insert_drive_file</mat-icon>
                {{node.name}}
            </mat-tree-node>
        </mat-tree>
    </div>
  
    <!-- Right Pane: File/Folder Display -->
    @if(selectedFolder.name) {
        <div class="file-pane">
            <div class="breadcrumb">
                <span>{{ selectedFolder.name || '' }}</span>
            </div>
      
            <mat-card>
                <mat-card-content>
                    <div class="table-container">
                        <table mat-table [dataSource]="displayedFilesAndFolders" class="dynamic-table">
                            <ng-container *ngFor="let column of displayedColumns let i = index" [sticky]="i <= 1" [matColumnDef]="column">
                                <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
                                @if(column === 'Action') {
                                    <td mat-cell *matCellDef="let element">
                                        <a [href]="element[column]" target="_blank">View</a>
                                    </td>
                                } @else {
                                    <td mat-cell *matCellDef="let element">{{ element[column] }}</td>
                                }
                            </ng-container>
        
                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>           
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    } @else {
        <div class="no-file-pane">
            <p>No Folders is opened</p>
        </div>
    }
</div>